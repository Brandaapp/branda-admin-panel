openapi: 3.0.3
info:
  description: |
    # Introduction

    Welcome to the Branda API documentation! The Branda API is used by both the Branda app and the Branda Admin
    Panel. While the API has some publicly-accessible routes, most require an API key to successfully complete an 
    operation (see the [Authentication and Security](#section/Authentication-and-Security) section for more details).

    # Authentication and Security

    Petstore offers two forms of authentication:
      - API Key
      - DB Key

    The API Key is a general-use token specified in the header of almost all requests sent to our API. Because the majority
    of this API deals with sensitive information related to service tracking, push notifications, or backend operations, API
    security is a crucial part of our development. Some routes are publicly-available, and will not have the API key marked as 
    *required* in the header parameters. If you would like more information regarding this key, and possibly gaining access
    for personal development or integration with other applications, please reach out to the Branda team.

    The DB Key is specific to `Admin`-related routes, and will be marked as such in routes that use it. This key will
    not be given out under any circumstances.

     # OpenAPI Specification
    This API is documented in **OpenAPI format**.
    It was **extended** to illustrate features of [generator-openapi-repo](https://github.com/Rebilly/generator-openapi-repo)
    tool and [ReDoc](https://github.com/Redocly/redoc) documentation. 
  title: Branda Admin Panel Backend
  version: 2.0.0
  contact:
    name: Branda Support
    email: brandaapp@gmail.com
    url: https://branda.app
  x-logo:
    url: 'https://branda.app/assets/img/icon/logo.png'
    altText: Petstore logo
    width: 100
  license:
    name: MIT License
    url: 'https://github.com/Brandaapp/branda-admin-panel/blob/main/LICENSE'
tags:
  - name: Admin
    description: Special resources used for administrative and diagnostic purposes within the Branda backend team.
  - name: Schedules
    description: CRUD resources related to creating and maintaining Place Schedules.
paths:
  /api/admin/dbConnect:
    get:
      tags:
        - Admin
      summary: Establish a DB Connection
      description: Opens a Mongoose connection to the Branda DB instance
      parameters:
        - in: header
          name: db_access_token
          description: DB Key that grants access to the function of this route
          required: true
          schema:
            type: string
      responses:
        200:
          description: Successfully opened DB connection
        401:
          description: Incorrect DB Key credentials
        405:
          description: Incorrect HTTP Method
        500:
          description: Internal server error, likely caused by Mongoose
          content:
            application/json:
              schema:
                type: object
                properties:
                  err:
                    type: string
                    description: Error thrown from internal service
                    example: |
                      MongooseError: The `uri` parameter to `openUri()` must be a string, got "undefined". 
                      Make sure the first parameter to `mongoose.connect()` or `mongoose.createConnection()` is a string.
                  msg:
                    type: string
                    description: Indication of why error was thrown
                    example: Error establishing connection to db
  /api/schedules:
    parameters:
      - in: header
        name: api_token
        description: API Key for sender verification and general security
        required: true
        schema:
          type: string
    get:
      tags:
        - Schedules
      summary: Fetch All Place Schedules
      description: Returns an array of the names and groups of all active place schedules
      responses:
        200:
          description: Returns an array of place schedules
          content:
            application/json:
              schema:
                type: array
                items:
                  schema: object
                  properties:
                    name:
                      description: Name of the place
                      example: The Stein
                    group:
                      description: Group the place belongs to
                      example: Dining
        405:
          description: Incorrect HTTP method
        500:
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/responses/mongoError"
    post:
      tags:
        - Schedules
      summary: Add a New Place Schedule
      description: Constructs and adds a new place schedule with a given name, eomployee ID, group and weeks data
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - emp_id
                - Name
                - group
              properties:
                emp_id:
                  type: string
                  description: Employee ID for the new place schedule
                  example: 5b9b485dabd11f5920423a1c
                Name:
                  type: string
                  description: Name for the new place schedule
                  example: The Stein
                group:
                  type: String
                  description: The group the new place schedule belongs to
                  example: Dining
                active:
                  type: integer
                  description: 1 represents an active place schedule, 0 represents an inactive place schedule
                  exmaple: 1
                  default: 1
                  format: int32
                weeks:
                  type: array
                  default: []
                  description: Array with the schedules for each week of the year.
                  items:
                    type: object
                    properties:
                      sunday:
                        description: Schedule on a Sunday of a given week (based on the array index)
                        type: string
                        format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                      monday:
                        description: Schedule on a Monday of a given week (based on the array index)
                        type: string
                        format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                      tuesday:
                        description: Schedule on a Tuesday of a given week (based on the array index)
                        type: string
                        format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                      wednesday:
                        description: Schedule on a Wednesday of a given week (based on the array index)
                        type: string
                        format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                      thursday:
                        description: Schedule on a Thursday of a given week (based on the array index)
                        type: string
                        format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                      friday:
                        description: Schedule on a Friday of a given week (based on the array index)
                        type: string
                        format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                      saturday:
                        description: Schedule on a Saturday of a given week (based on the array index)
                        type: string
                        format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                sunday:
                  description: General Sunday schedule
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                  example: "12:00pm-5:00pm"
                monday:
                  description: General Monday schedule
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                  example: "9:00am-5:00pm"
                tuesday:
                  description: General Tuesday schedule
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                  example: "9:00am-5:00pm"
                wednesday:
                  description: General Wednesday schedule
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                  example: "9:00am-5:00pm"
                thursday:
                  description: General Thursday schedule
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                  example: "9:00am-5:00pm"
                friday:
                  description: General Friday schedule
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                  example: "9:00am-5:00pm"
                saturday:
                  description: General Saturday schedule
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                  example: "11:00am-5:00pm"
      responses:
        200:
          description: Schedule successfully created
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/PlaceSchedule"
        405:
          description: Incorrect HTTP method
        500:
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/responses/mongoError"
  /api/schedules/{week}:
    get:
      tags:
        - Schedules
      summary: Get Week Schedule for All Places
      description: Fetches the week data for all places based on a spacific week
      parameters:
        - in: header
          name: api_token
          description: API Key for sender verification and general security
          required: true
          schema:
            type: string
        - in: path
          name: week
          description: Week of the year to get schedules for (0-based)
          required: true,
          schema:
            type: integer
            format: int32
          example: 30
      responses:
        200:
          description: Successfully fetched all schedules for a given week
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    name:
                      description: Place name
                      type: string
                      example: The Stein
                    emp_id:
                      description: Place employee ID
                      type: string
                      example: 5b9b485dabd11f5920423a1c
                    sunday:
                      description: Place's week schedule for Sunday
                      type: string
                      example: "12:00pm-5:00pm"
                    monday:
                      description: Place's week schedule for Monday
                      type: string
                      example: "9:00am-5:00pm"
                    tuesday:
                      description: Place's week schedule for Tuesday
                      type: string
                      example: "9:00am-5:00pm"
                    wednesday:
                      description: Place's week schedule for Wednesday
                      type: string
                      example: "9:00am-5:00pm"
                    thursday:
                      description: Place's week schedule for Thursday
                      type: string
                      example: "9:00am-5:00pm"
                    friday:
                      description: Place's week schedule for Friday
                      type: string
                      example: "9:00am-5:00pm"
                    saturday:
                      description: Place's week schedule for Saturday
                      type: string
                      example: "11:00am-5:00pm"
        405:
          description: Incorrect HTTP method
        500:
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/responses/mongoError"
  /api/schedules/{week}/{id}:
    parameters:
      - in: header
        name: api_token
        description: API Key for sender verification and general security
        required: true
        schema:
          type: string
      - in: path
        name: week
        description: Week of the year to get schedules for (0-based)
        required: true
        schema:
          type: integer
          format: int32
        example: 30
      - in: path
        name: id
        description: Employee ID to get the schedule for
        required: true
        schema:
          type: string
        example: 5b9b46afd5e64959c00eb455
    get:
      tags:
        - Schedules
      summary: Get Week Schedule for A Specific Place
      description: Fetches the week data for a specific schedule based on week and place id
      responses:
        200:
          description: Successfully fetched specific place's schedule on a specific week
          content:
            application/json:
              schema:
                type: object
                properties:
                  week:
                    description: Week selected
                    type: integer
                    format: int32
                    example: 30
                  sunday:
                    description: Sunday schedule for the specific week
                    type: string
                    example: "12:00pm-7:00pm"
                  monday:
                    description: Monday schedule for the specific week
                    type: string
                    example: "11:00am-11:00pm"
                  tuesday:
                    description: Tuesday schedule for the specific week
                    type: string
                    example: "11:00am-11:00pm"
                  wednesday:
                    description: Wednesday schedule for the specific week
                    type: string
                    example: "11:00am-11:00pm"
                  thursday:
                    description: Thursday schedule for the specific week
                    type: string
                    example: "11:00am-11:00pm"
                  friday:
                    description: Friday schedule for the specific week
                    type: string
                    example: "11:00am-8:00pm"
                  saturday:
                    description: Saturday schedule for the specific week
                    type: string
                    example: "12:00am-8:00pm"
        404:
          description: Place schedule not found, indicative of non-existent employee ID
        405:
          description: Incorrect HTTP method
        500:
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/responses/mongoError"
    patch:
      tags:
        - Schedules
      summary: Update Week Schedule for A Specific Place
      description: Updates the week data for a specific schedule based on week and place id
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - sunday
                - monday
                - tuesday
                - wednesday
                - thursday
                - friday
                - saturday
              properties:
                sunday:
                  description: New Sunday schedule for the place on a specific week
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                  example: "12:00pm-5:00pm"
                monday:
                  description: New Monday schedule for the place on a specific week
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                  example: "9:00am-5:00pm"
                tuesday:
                  description: New Tuesday schedule for the place on a specific week
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                  example: "9:00am-5:00pm"
                wednesday:
                  description: New Wednesday schedule for the place on a specific week
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                  example: "9:00am-5:00pm"
                thursday:
                  description: New Thursday schedule for the place on a specific week
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                  example: "9:00am-5:00pm"
                friday:
                  description: New Friday schedule for the place on a specific week
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                  example: "9:00am-5:00pm"
                saturday:
                  description: New Saturday schedule for the place on a specific week
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                  example: "11:00am-5:00pm"
      responses:
        200:
          description: Successfully patched week schedule
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlaceSchedule'
        405:
          description: Incorrect HTTP method
        500:
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/responses/mongoError"
  /api/schedules/delete:
    parameters:
      - in: header
        name: api_token
        description: API Key for sender verification and general security
        required: true
        schema:
          type: string
    patch:
      summary: Change a Place Schedule to Inactive
      description: Effectively delete a place schedule by setting it's `active` property to `0`.
      tags:
        - Schedules
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - emp_id
              properties:
                emp_id:
                  description: Employee ID for the place to "delete"
                  type: string
      responses:
        200:
          description: Successfully deactivated the place
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PlaceSchedule'
        405:
          description: Incorrect HTTP method
        500:
          description: Internal server error
          content:
            application/json:
              schema:
                $ref: "#/components/responses/mongoError"
components:
  responses:
    mongoError:
      type: object
      properties:
        err:
          description: Error thrown
          type: string
          example: |
            MongooseError: The `uri` parameter to `openUri()` must be a string, got "undefined". 
            Make sure the first parameter to `mongoose.connect()` or `mongoose.createConnection()` is a string.
  schemas:
    PlaceSchedule:
      type: object
      properties:
          _id:
            description: Mongoose-assigned Object Id
            type: ObjectId
          emp_id:
            type: string
            description: Employee ID for the new place schedule
          Name:
            type: string
            description: Name for the new place schedule
          group:
            type: string
            description: Group for the new place schedule
          weeks:
            type: array
            description: Array with the schedules for each week of the year.
            items:
              type: object
              properties:
                sunday:
                  description: Schedule on a Sunday of a given week (based on the array index)
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                monday:
                  description: Schedule on a Monday of a given week (based on the array index)
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                tuesday:
                  description: Schedule on a Tuesday of a given week (based on the array index)
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                wednesday:
                  description: Schedule on a Wednesday of a given week (based on the array index)
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                thursday:
                  description: Schedule on a Thursday of a given week (based on the array index)
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                friday:
                  description: Schedule on a Friday of a given week (based on the array index)
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
                saturday:
                  description: Schedule on a Saturday of a given week (based on the array index)
                  type: string
                  format: "h:mm[aApP][mM]-h:mm[aApP][mM]"
          sunday:
            description: General Sunday schedule
            type: string
          monday:
            description: General Sunday schedule
            type: string
          tuesday:
            description: General Sunday schedule
            type: string
          wednesday:
            description: General Sunday schedule
            type: string
          thursday:
            description: General Sunday schedule
            type: string
          friday:
            description: General Sunday schedule
            type: string
          saturday:
            description: General Sunday schedule
            type: string
          active:
            description: 1 represents an active place schedule, 0 represents an inactive place schedule
            type: integer
            format: int32
          __v:
            description: Mongoose-tracked internal revision of the document
            type: integer
            format: int32
      example:
          _id: 6bcb285dabd114f592f423a6c
          emp_id: 5b9b485dabd11f5920423a1c
          Name: The Stein
          group: Dining
          weeks: []
          sunday: '12:00pm-5:00pm'
          monday: '9:00am-5:00pm'
          tuesday: '9:00am-5:00pm'
          wednesday: '9:00am-5:00pm'
          thursday: '9:00am-5:00pm'
          friday: '9:00am-5:00pm'
          saturday: '11:00am-5:00pm'
          active: 1
          __v: 0